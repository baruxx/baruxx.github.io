<!doctype html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>xA01 room</title>
		<link href="https://fonts.googleapis.com/css?family=Stylish" rel="stylesheet">
		
	</head>
	<body>
		<div class='page'><em><strong><h1>xA01 writeup</h1></strong></em><em><br /><br />This is an official writeup for </em><a href="https://tryhackme.com/jr/xa01" target="_blank">xA01 room</a><em> on </em><a href="https://tryhackme.com" target="_blank">TryHackMe</a><em>.<br />Let&#39;s start by doing some reconnaissance about the target machine using nmap<br /><br /></em><a href=""><img src="images/1-1.png" alt="images/1-1.png" /></a><br /><br /><em>We see that there are 3 opened ports (21:ftp, 22:ssh, 80:http)<br />Nmap is telling us that we can login into ftp as anonymous. so let&#39;s try! 🤓<br /><br /><a href=""><img src="images/1-2.png" alt="images/1-2.png" /></a><br /><br />There is a file with name “message.txt”. let&#39;s get it and read it content<br /><br /><a href=""><img src="images/1-3.png" alt="images/1-3.png" /></a><br /><br />Hmmm, interesting infos...<br />Let&#39;s take a look at the http server<br /><br /><a href=""><img src="images/1-4.png" alt="images/1-4.png" /></a><br /><br />There is nothing important... Navigating to the directory path founded in the previous file (/sdoadmomfois/)<br /><br /><a href=""><img src="images/1-5.png" alt="images/1-5.png" /></a><br /><br /><span style="color:#242424;">We have two buttons that lead to &quot;/view.php?file=hint” and “/view.php?file=flag” respectivel</span>y<br /><span style="color:#242424;">When we click either one we get </span>a blank page<br />The parameter included (file) looks like it tries to view a file from the server<br />Let&#39;s try some LFI payloads<br />I&#39;ll try to read the passwd file located in “/etc/passwd&quot;<br />Finally, after some tries, we get the output of the file using this path “../../../../../etc/passwd”<br /><br /><a href=""><img src="images/1-6.png" alt="images/1-6.png" /></a><br /><br />Moving to “message.txt”, it said to “3obi” to change permissions of the log file because it is readable<br />So we know that the web is running apache2 server and it log file is located in “/var/log/apache2/access.log”<br />Let&#39;s read it :)<br /><br /><a href=""><img src="images/1-7.png" alt="images/1-7.png" /></a><br /><br />It works, it&#39;s readable!<br />let&#39;s try to add this code execution (<code>&lt;?php system($_GET[&#39;cmd&#39;]);?&gt;</code>) to the log file by requesting it<br />but this time we&#39;ll use netcat<br /><br /><a href=""><img src="images/1-8.png" alt="images/1-8.png" /></a><br /><br />Good job!<br />Let&#39;s add now cmd parameter to the url and inserting “id” command<br /><br /><a href=""><img src="images/1-9.png" alt="images/1-9.png" /></a><br /><br />it works! we&#39;re running as “www-data”<br />let&#39;s replace id command by a reverse shell<br /><br /><a href=""><img src="images/1-10.png" alt="images/1-10.png" /></a><br /><br />and it works! we get a foothold into the machine<br />Hmmm, there is a user called “3obi” in home directories<br />after listing it content <span style="color:#242424;">by running “ls -la” in</span>cluding hidden files<br /><br /><a href=""><img src="images/1-11.png" alt="images/1-11.png" /></a><br /><br />we get the first flag and there is a hidden file “.secret” which it contains the password of “3obi”<br /><br /><a href=""><img src="images/1-12.png" alt="images/1-12.png" /></a><br /><br />let&#39;s login as “3obi” using ssh<br /><br /><a href=""><img src="images/1-13.png" alt="images/1-13.png" /></a><br /><br />we&#39;re “3obi” now and we need to get root privileges<br />Running “sudo -l” reveals that we can execute “/usr/sbin/arp” as root without a password<br /><br /><a href=""><img src="images/1-14.png" alt="images/1-14.png" /></a><br /><br />Let’s use it to get an elevated shell<br /><a href="https://gtfobins.github.io/">GTFOBins</a> said that we can read any file using arp<br />Hmmm, can we read the shadow file located in “/etc/shadow” and cracked root hash. Let&#39;s see!<br /><br /><a href=""><img src="images/1-15.png" alt="images/1-15.png" /></a><br /><br />We get it. Let&#39;s cracked it now using John the Ripper<br />First of all, we must create a file including the hash and run the command below:<br /><br /><a href=""><img src="images/1-16.png" alt="images/1-16.png" /></a><br /><br />Finally, we get root password and we can read the root flag “root.txt”<br /><br /><a href=""><img src="images/1-17.png" alt="images/1-17.png" /></a><br /><br />Thanks for reading, hope you learned something :)<br /><br /><span style="text-decoration:underline;">Enjoy!</em></span><br /><br /><br /></div>
	</body>
</html>
